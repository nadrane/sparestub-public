{% load tz %}
{% load misc_filters %}
{% load static %}

<tr>
  {% comment %}Turn localtimeoff because the events might be in a different timezone than the user. We don't want to
  convert the event time to the timezone of the user but to the timezone of the event's location.
  Ticket.get_formatted_start_datetime does this for us. Django will undo the change if localtime is on {% endcomment %}
  <td class="col-xs-2 col-sm-1"><a href="{{ ticket.get_absolute_url }}" target="_blank" >{% localtime off %}{{ ticket.get_formatted_start_datetime.date }}<br>{{ ticket.get_formatted_start_datetime.time }}{% endlocaltime %}</a></td>
  <td class="col-xs-2 col-sm-1">
    ${{ ticket.price }} <br>
    {% comment %}TODO enable secure payment{{ ticket.get_payment_method_display }}{% endcomment %}
  </td>
  <td class="col-xs-2 col-sm-1">{{ ticket.location }}<br>{{ ticket.venue | truncatechars:50}}</td>
  <td class="col-xs-2 col-sm-3">{{ ticket.title | truncatechars:200}}</td>
  <td class="hidden-xs col-sm-3">
    <img style="height: 100%; max-height: 75px;" class="pull-left" src="{% if ticket.poster.profile_picture.search_thumbnail.url %}{{ ticket.poster.profile_picture.search_thumbnail.url }}{% else %}{% static "sparestub/logos/lilman.jpg" %}{% endif %}">
    <div style="padding-left: 10px;" class="pull-left">
      {{ ticket.poster}}{% if ticket.poster.age %}, {{ ticket.poster.age }}{% endif %}
      <br>
      <span>
        {% for x in ticket.poster.rating|get_range %}
          <span class="glyphicon glyphicon-star"></span>
        {% endfor %}
      </span>
    </div>
  </td>
</tr>